!function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function t(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,r)}}function r(r){return function(t){if(Array.isArray(t))return e(t)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||t(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n={IDLE:"idle",PLAYING:"playing",WIN:"win",LOSE:"lose"},i=new/*#__PURE__*/(function(){var e;function i(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),this.gridSize=4,this.winningValue=2048,this.reset()}return e=[{key:"reset",value:function(){this.grid=this.createEmptyGrid(),this.score=0,this.status=n.IDLE}},{key:"start",value:function(){this.status=n.PLAYING,this.addNewTile(),this.addNewTile()}},{key:"restart",value:function(){this.reset()}},{key:"moveLeft",value:function(){this.processMove("left")}},{key:"moveRight",value:function(){this.processMove("right")}},{key:"moveUp",value:function(){this.processMove("up")}},{key:"moveDown",value:function(){this.processMove("down")}},{key:"updateScore",value:function(e){this.score=this.score+e}},{key:"processMove",value:function(e){var t=this.calculateNewGrid(e);this.gridsAreEqual(this.grid,t)||(this.grid=t,this.addNewTile(),this.updateGameStatus())}},{key:"calculateNewGrid",value:function(e){switch(e){case"left":return this.moveHorizontal(!1);case"right":return this.moveHorizontal(!0);case"up":return this.moveVertical(!1);case"down":return this.moveVertical(!0);default:return this.copyGrid()}}},{key:"moveHorizontal",value:function(e){var t=this;return this.grid.map(function(n){var i=r(n);return e&&i.reverse(),i=t.mergeLine(i),e&&i.reverse(),i})}},{key:"moveVertical",value:function(e){for(var t=this,r=function(r){var i=t.grid.map(function(e){return e[r]});e&&(i=i.reverse());var o=t.mergeLine(i);e&&o.reverse(),t.setColumn(n,r,o)},n=this.createEmptyGrid(),i=0;i<this.gridSize;i++)r(i);return n}},{key:"mergeLine",value:function(e){for(var t=e.filter(function(e){return 0!==e}),r=0,n=0;n<t.length-1;n++)t[n]===t[n+1]&&(t[n]*=2,r+=t[n],t.splice(n+1,1));for(this.score+=r;t.length<this.gridSize;)t.push(0);return t}},{key:"createEmptyGrid",value:function(){var e=this;return Array.from({length:this.gridSize},function(){return Array(e.gridSize).fill(0)})}},{key:"copyGrid",value:function(){return this.grid.map(function(e){return r(e)})}},{key:"setColumn",value:function(e,t,r){r.forEach(function(r,n){e[n][t]=r})}},{key:"gridsAreEqual",value:function(e,t){return e.every(function(e,r){return e.every(function(e,n){return e===t[r][n]})})}},{key:"addNewTile",value:function(){var e=[];if(this.grid.forEach(function(t,r){t.forEach(function(t,n){0===t&&e.push([r,n])})}),e.length>0){var r,n=function(e){if(Array.isArray(e))return e}(r=e[Math.floor(Math.random()*e.length)])||function(e,t){var r,n,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var o=[],a=!0,s=!1;try{for(i=i.call(e);!(a=(r=i.next()).done)&&(o.push(r.value),2!==o.length);a=!0);}catch(e){s=!0,n=e}finally{try{a||null==i.return||i.return()}finally{if(s)throw n}}return o}}(r,2)||t(r,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=n[0],o=n[1];this.grid[i][o]=.9>Math.random()?2:4}}},{key:"updateGameStatus",value:function(){this.hasWinningTile()?this.status=n.WIN:this.hasPossibleMoves()||(this.status=n.LOSE)}},{key:"hasWinningTile",value:function(){var e=this;return this.grid.some(function(t){return t.includes(e.winningValue)})}},{key:"hasPossibleMoves",value:function(){if(this.grid.some(function(e){return e.includes(0)}))return!0;for(var e=0;e<this.gridSize;e++)for(var t=0;t<this.gridSize;t++){var r=this.grid[e][t],n=t<this.gridSize-1&&r===this.grid[e][t+1],i=e<this.gridSize-1&&r===this.grid[e+1][t];if(n||i)return!0}return!1}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.copyGrid()}},{key:"getStatus",value:function(){return this.status}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(i.prototype,e),i}()),o=document.querySelector(".game-score"),a=document.querySelector(".button.start"),s=document.querySelectorAll(".field-cell"),u=document.querySelector(".message-win"),c=document.querySelector(".message-lose"),l=document.querySelector(".message-start");function f(){var e,t;e=i.getState(),s.forEach(function(t,r){var n=e[Math.floor(r/4)][r%4];t.textContent="",t.className="field-cell".concat(n?" field-cell--".concat(n):"")}),o.innerHTML=i.getScore(),t=i.getStatus(),u.classList.toggle("hidden",t!==n.WIN),c.classList.toggle("hidden",t!==n.LOSE),l.classList.toggle("hidden",t!==n.IDLE)}a.addEventListener("click",function(){a.classList.contains("start")?(i.start(),a.textContent="RESTART",a.classList.replace("start","restart")):(i.restart(),a.textContent="START",a.classList.replace("restart","start")),f()}),document.addEventListener("keydown",function(e){if(i.getStatus()===n.PLAYING){switch(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)&&e.preventDefault(),e.key){case"ArrowLeft":i.moveLeft();break;case"ArrowRight":i.moveRight();break;case"ArrowUp":i.moveUp();break;case"ArrowDown":i.moveDown();break;default:return}f()}})}();
//# sourceMappingURL=index.0f5d98b8.js.map
